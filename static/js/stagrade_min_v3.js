var modules=0;$(document).ready(function(){$("#start-button").click(animateRemoveText);$(window).resize(windowResize)});function windowResize(){var b=$(window).height();var a=$(".center-window").height();if(a){if(b<=a){$(".center-window").css({position:"static",top:"auto",left:"auto",right:"auto",bottom:"auto"})}else{if(b>a){$(".center-window").css({position:"absolute",top:0,bottom:0,left:0,right:0})}}}}function animateRemoveText(){var a=$(".explanation");a.fadeOut(400,function(){a.remove()});$(".center-window").animate({height:"250px"},500,function(){animateAddForm()})}function animateAddForm(){$("<div/>",{id:"rows","class":"calculator-form"}).appendTo(".body");var a=animateAddInputRow(true,false);$("<div/>",{"class":"buttons"}).appendTo(".body");$("<input/>",{id:"new_row_button","class":"button-1",type:"button",name:"newrow",value:"New Module"}).hide().appendTo(".buttons").fadeIn(400).click(function(){animateAddInputRow(true,true)});$("<input/>",{id:"calculate_button","class":"button-1 button-2",type:"button",name:"calculate",value:"CALCULATE!"}).hide().click(calculate).appendTo(".buttons").fadeIn(400)}function animateAddInputRow(b,d){modules++;var c="module-row"+modules;var a=$("<div/>",{id:c,"class":"input-row"}).hide().appendTo(".calculator-form");$("<input/>",{type:"text",name:"grade",placeholder:"Module Grade"}).appendTo("#"+c);$("<input/>",{type:"text",name:"credits",placeholder:"Module Credits"}).appendTo("#"+c);$("<input/>",{type:"button","class":"button-1 button-close",name:"close",value:"x"}).click(function(){animateDeleteRow($(this))}).appendTo("#"+c);if(d&&b){a.slideDown(400);changeHeightOfCenterWindow(45)}else{if(b){a.fadeIn(400)}else{a.show()}}}function animateDeleteRow(a){a.parent().slideUp(400,function(){$(this).remove()});changeHeightOfCenterWindow(-45)}function changeHeightOfCenterWindow(d){var c=$(".center-window").height();var b=c+d;var a=function(e){};if(($(window).height()<=b)&&($(window).height()>c)){a=function(e){e.css({position:"static",top:"auto",left:"auto",right:"auto",bottom:"auto"})}}else{if(($(window).height()>b)&&($(window).height()<=c)){a=function(e){e.css({position:"absolute",top:0,bottom:0,left:0,right:0})}}}$(".center-window").animate({height:c+d+"px"},400,a($(".center-window")))}function calculate(){var c=$("#rows");var a=[];var b=true;c.children("div").each(function(){var e=$(this).children("input[name=grade]").val();var d=$(this).children("input[name=credits]").val();e=parseInt(e,10);d=parseInt(d,10);if(validateRow(e,d)){a.push({grade:e,credits:d});$(this).children("input").removeClass("failed")}else{b=false;$(this).children("input").addClass("failed")}});if(b){displayResult(CWM(a),CWMedian(a))}}function displayResult(c,e){var f=classificationFromGrades(c,e);var a="<p>With a credit-weighted mean of "+c.toString()+" and a credit-weighted median of "+e.toString()+", you will graduate with "+f+".</p>";var d=maybeCreateResultsDiv();var b=$("#results");b.empty();b.append(a);if(d){b.slideDown(400);changeHeightOfCenterWindow(90)}}function maybeCreateResultsDiv(){var a=$(".body").children("#results");if(a.length===0){return $("<div/>",{"class":"results",id:"results"}).hide().appendTo(".body")}else{return null}}function validateRow(b,a){if(isNaN(b)||(b<0)||(b>20)||isNaN(a)||(a<0)||(a>120)||!isInt(a)){return false}else{return true}}function CWM(c){var d=0;var a=0;for(var b=0;b<c.length;b++){d+=(c[b].grade*c[b].credits);a+=c[b].credits}return(d/a)}function CWMedian(c){c.sort(function(f,e){return(f.grade-e.grade)});var d=0;for(var b=0;b<c.length;b++){d+=c[b].credits}var a=(d+1)/2;if(isInt(a)){d=0;for(b=0;b<c.length;b++){d+=c[b].credits;if(d>=a){return c[b].grade}}}else{d=0;for(b=0;b<c.length;b++){d+=c[b].credits;if(((a-0.5)==d)&&((a+0.5)>d)){return((c[b+1].grade+c[b].grade)/2)}else{if(d>a){return c[b].grade}}}}}function isInt(a){if((parseFloat(a)==parseInt(a,10))&&!isNaN(a)){return true}else{return false}}function classificationFromGrades(a,b){if(a>=16.5){return"First Class Honours"}else{if((a>=16)&&(b>=16.5)){return"First Class Honours"}else{if(a>=13.5){return"Upper Second Class Honours (II.1)"}else{if((a>=13)&&(b>=13.5)){return"Upper Second Class Honours (II.1)"}else{if(a>=10.5){return"Lower Second Class Honours (II.2)"}else{if((a>=10)&&(b>=10.5)){return"Lower Second Class Honours (II.2)"}else{if(a>=7.5){return"Third Class Honours"}else{if((a>=7)&&(b>=7.5)){return"Third Class Honours"}else{return'a degree "Not of Honours Standard"'}}}}}}}}};